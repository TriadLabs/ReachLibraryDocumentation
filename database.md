---
layout: default
title: Database Architecture
nav_order: 6
---

1. TOC
{:toc}

# The Reach Database

The Reach system includes 1) the Reach Shoulder Health VR application, 2) a web portal where end-users can view their progress, and 3) 3rd party games and experiences that interface with Reach APIs. Each of these three components may access Reach databases.

Currently, Reach uses a staging database for development/testing and a production database for end-users.

To be granted database access, [contact the Reach development team.](mailto:support@triadlabs.com){:target='_blank'}

In general, changes and additions to the database structure are made and managed via the Django ORM in order to keep everything neat and tidy. If you are developing an application in conjunction with the Reach team and would like to request additions or updates to the database, [contact the Reach DB admin.](mailto:support@triadlabs.com){:target='_blank'}

# Database Architecture

The database architecture for Reach system components can be divided broadly into tables used primarily for/by Django and tables used primarily for/by VR applications.

## Django Tables and Functions

| User Auth, Permissions, & Profiles   | Description         |
|:-------------------------------|:--------------------|
| account_emailaddress                  | Django-generated table to track user email addresses |
| account_emailconfirmation             | Django-generated table to track user email addresses confirmations |
| auth_group                            | Django-generated table to manage Django user permissions. Not currently used very much.   |
| auth_group_permissions                | Django-generated table to manage Django user permissions. Not currently used very much.   |
| auth_permission                       | Django-generated table to manage Django user permissions. Not currently used very much.   |
| authtoken_token                       | Django plugin generated table to manage token authentication. 3rd party developers may request a token, and tokens reside in this table. Tokens currently do not expire.  |
| Client                                | Profile information that is associated with a ReachUser table entry by means of the user_id foreign key. Currently, the most important entry in this table other than the user_id field is OculusLinkId, which represents the value that end-users have entered for their Oculus account usernames.   |
| django_admin_log                      | Django-generated table to track admin-related changes  |
| django_content_type                   | Django-generated table to parse content types as defined by the Django ORM   |
| django_migrations                     | Django-generated table that tracks "migrations," Django's term for changes made to the database via the Django ORM   |
| django_session                        | Django-generated table that tracks Django user sessions   |
| django_site                           | Django-generated table that manages the overall "site" entry/multi-site entries   |
| OculusToReachUserLink                 | A lookup table of entries generated by the Reach Shoulder Health application that defines the relationship between an Oculus user's screen name (oculus_link) and their Oculus-generated user number (oculus_user). This table is shared somewhat evenly between the web portal and Reach VR applications. |
| Organization                          | A table that defines Organizations, e.g. companies, research institutions, clinics, or other organizations that use Reach and wish to group users together for viewing progress on the portal.  |
| OrganizationOwner                     | A table that defines the owner of an organization. An org owner may approve organization join requests and assign roles to other org members.  |
| OrganizationUser                      | A table that relates ReachUser entries as members of a particular organization. Any Reach user may also request to become an Organization user. |
| OrganizationUser_role                 | A table that makes the Roles table also apply to Organization users (when roles have been assigned by an Org Admin). |
| ReachUser                             | Core Django-generated table that handles user authentication, hashed passwords, user emails, etc. The is_staff and is_superuser flags are occasionally used internally by the team to enable us to see elevated admin functionality in both VR and the portal. The is_superuser flag currently enables VR users to view the admin panel with the Reach Shoulder Health application. |
| ReachUser_groups                      | A Django-generated table to manage groups for ReachUsers. Not currently in use. |
| ReachUser_user_permissions            | A Django-generated table to manage permissions for ReachUsers. Not currently in use. |
| Roles                                 | A table to define ReachUser and OrganizationUser roles. Currently only used in the context of Organization users. |
| sitetree_tree                         | A plugin-generated table. The SiteTree plugin allows breadcrumb navigation to be generated and edited by Django admin users. Each tree is defined as an individual entry in this table. |
| sitetree_treeitem                     | A plugin-generated table; associates individual navigation items (pages) with a site tree and defines their position in the navigation hierarchy. |
| sitetree_treeitem_access_permissions  | A plugin-generated table; sets permissions on SiteTree items. Not currently in use. |
| socialaccount_socialaccount           | Django-generated table that provides frameworking for users to use Social Sign In options. Not currently in use. |
| socialaccount_socialapp               | Django-generated table that provides frameworking for users to use Social Sign In options. Not currently in use. |
| socialaccount_socialapp_sites         | Django-generated table that provides frameworking for users to use Social Sign In options. Not currently in use. |
| socialaccount_socialtoken             | Django-generated table that provides frameworking for users to use Social Sign In options. Not currently in use. |



## Additional Portal Functionality Tables

| Table Name                     | Description         |
|:-------------------------------|:--------------------|
| MarketingSignup                | A table used to integrate Reach web portal sign-ups with 3rd party marketing and user engagement tools.   |
| ReachSurvey                    | A table that defines ids and names of surveys that Reach users may take.  |
| ReachSurveyQuestion            | A table that defines questions and answer types for Reach surveys.  |
| ReachSurveyQuestion_survey     | A one-to-many table that associates survey questions with Reach surveys. |
| ReachSurveyResponse            | A table that records individual responses to Reach surveys. |
| ReachSurveyResponseGroup       | A table that records a datetime for a group of individual survey responses and associates the response group with a ReachUser id. |



## Reach VR Tables and Functions

| Table Name                     | Description         |
|:-------------------------------|:--------------------|
| MotionCaptureSettings          | Reach uses the settings in this table to define global behaviors for motion tracking and target-generation. |
| OculusToReachUserLink          | A lookup table of entries generated by the Reach Shoulder Health application that defines the relationship between an Oculus user's screen name (oculus_link) and their Oculus-generated user number (oculus_user). This table is shared somewhat evenly between the web portal and Reach VR applications. |
| ReachParameters                | Reach uses the settings in this table to define global behaviors for motion tracking and target-generation. |
| ReachVersion                   | The Reach VR application, when installed client-side, will check this table upon running the program to see if an update is required. |
| VolumeSegment                  | --(Deprecated) This table is used to store the individual x,y,z coordinates that make up a VolumeSegmentSequence. This was used to create custom motion paths that were user genereated in the Reach App. This table will be phased out soon.  |
| VolumeSegmentSequence          | --(Deprecated) This table is used to record custom motion sequences in the Reach App. It records the metadata associated with a single recorded sequence but not the actual points that compose the sequence itself. |
| VRDevices                      | Lookup table for VR devices. Reach uses this table to record analytics data on which devices are recording data in the system. This table is currently not used by any of the Reach systems. |
| VRGameAnalytics                | --(Deprecated) This table used to calcualte time spent in an application |
| VRGames                        | Lookup table for all games played in the Reach System. This allows anyone who uploads data into the Reach System to be able to tag that data to show which game the data came from. |
| VRGamesLink                    | --(Deprecated) This table is no longer in use |
| VRMotionCapture                | --(Deprecated) This table was deprecated in place of VRMotionCaptureSession. |
| VRMotionCaptureCollisionItem   | This table stores all the calculated collision points from a specific VRMotionCaptureSession. When playing a session, any prescribed points that are within a set radius of Demonstrated motion in a session are recorded as collisions in this table. |
| VRMotionCaptureDemonstratedItem| This table stores all the demonstrated points from a specific VRMotionCaptureSession. When playing a session, point data is automatically collected and later uploaded along with prescribed and collision data for a session. |
| VRMotionCapturePrescribedItem  | This table stores all the calculated prescribed points from a specific VRMotionCaptureSession. When playing a session, prescribed points are generated by the Reach algorithims and are the points that are meant to be prescribed to the user during a session. |
| VRMotionCaptureSession         | This table stores the metadata for any motion data collected in Reach experiences. The Id associated with this record is used to lookup corresponding demonstrated, prescribed, and collision data. |




## Reach VR Table Details

### MotionCaptureSettings

| Field Name                     | Description         |
|:-------------------------------|:--------------------|
| id          | Autogenerated ID |
| GridDensity          | Description goes here. |
| FireflyLifespan          | This property determines how long an individual firefly will be displayed to the user in either the Reach Assessment or Chase modes. |
| MaxFireflies          | How many fireflies appear at a time (applies only to the Reach Assessment) |
| NumberOfTimesToPrescribeEachPoint          |  --(Deprecated) How many times to display a single point before counting a point as missed. Applies only to the Reach Assessment |
| CompensationEnabled          |  --(Deprecated) Enabled the Reach Compensation module in the Reach App. Compensation is no longer implemented. |
| IdleTimeout          | How long until the Reach App decides to skip to the next round in the experience. THe assessment uses the raw value while Chase modes use IdleTimeout/2. |
| SampleRate        | This property determines the data collection rate for motion data. .15 means that point data is collected every .15 seconds. |
| HitPointThreshold          | This is used to determine the collider size used to show a collision between a firefly and the hand during gameplay |
| FinalRoundTimeInSeconds          | Some Reach Apps have a concept of a final round where prescribed points that weren't hit during the main rounds are shown to the user one final time. This determines how long that final round lasts. |
| MaxArmLength          | This sets the upper bound for what a calculated Arm length can be during the Arm Length calibration step in the Reach App |
| MinArmLength          | This sets the lower bound for what a calculated Arm length can be during the Arm Length calibration step in the Reach App. |


### ReachParameters

Entries in this table may or may not be applied universally (i.e. to all Reach VR experiences). Check the value in the "Universal" column (0 = not universal, 1 = universal).

GameId indicates whether/how the value was generated for a particular game in the VRGames table.

| Entry Name                     | Description         |
|:-------------------------------|:--------------------|
| id          | Description goes here. |
| GridDensity          | Description goes here. |
| FireflyLifespan          | Description goes here. |
| MaxFireflies          | Description goes here. |
| NumberOfTimesToPrescribeEachPoint          | Description goes here. |
| IdleTimeout          | Description goes here. |
| SampleRate        | Description goes here. |
| HitPointThreshold          | Description goes here. |
| FinalRoundTimeInSeconds          | Description goes here. |
| MaxArmLength          | Description goes here. |
| MinArmLength          | Description goes here. |
| PrecisionMaxColliderGranularity |
| PrecisionMinColliderGranularity |

### VolumeSegment

| Field Name                     | Description         |
|:-------------------------------|:--------------------|
| id          | Autogenerated |
| SequenceId          | Indicates that they belong to a specific VolumeSegmentSequence. |
| OrderIndex          | Indicates the order in which this point was recorded in the sequence. |
| CoordinateKeyX          | X Coordinate of the point |
| CoordinateKeyY          | Y Coordinate of the point |
| CoordinateKeyZ          | Z Coordinate of the point |

### VolumeSegmentSequence

| Field Name                     | Description         |
|:-------------------------------|:--------------------|
| SegmentId          | Autogenerated. Used as a key for VolumeSegmentSequnce items to indicate that they belong to the specified sequence. |
| SegmentName          | Name generated by the Reach Recorder |
| Radius          | Space between points. Higher value indicates larger space between points. |
| TargetGranularity          | How  |
| ColliderGranularity          | Description goes here. |
| Velocity          | Not in use. |
| Timeout          | How long a user is given to hit every point in the sequence. |
| GraphicPath          | URL for the picture associated with a sequence |
| MaxFireflies          | Max nubmer of fireflies to display at a time when prescribing this sequence. |
| SegmentFriendlyName          | Human readable name for the sequence. |
| AnimationPath          | URL for the animation associated with a sequence |
| NumSegments          | Total number of VolumeSegment points that are associated with this sequence |
| GameId          | GameId assocaited with this sequence (not in use) |
| ArmLengthInInches          | ArmLength of the user who recorded this sequence. Reach uses this arm length to scale points to the users arm length who is being prescribed that sequence |
| IsHull          | Determines whether this sequence is treated as a convex hull where a 3D convex hull is generated and points are "infilled". |
| IsRecordedTemplate          | Determines whether this was a recorded sequence or created one |
| IsSequence          | Determines whether the sequence points should be prescribed in the order they were recorded. |
| ShoulderX          | X Offset of the shoulder of the point recorder. Used to scale points for the user. |
| IsActive          | --(Deprecated) |
| InsertTime          | When the sequence was recorded |
| CreatedBy          | The Oculus User ID of the recorder of the sequence. |

### VRMotionCaptureCollisionItem

| Field Name                     | Description         |
|:-------------------------------|:--------------------|
| id                        | Autogenerated. |
| InsertTime                | What time the point entered the database |
| Hand                      | Which hand the point belonged to |
| CoordinateX               | X coordinate of the point. |
| CoordinateY               | Y coordinate of the point |
| CoordinateZ               | Z coordinate of the point |
| VRMotionCaptureSessionId  | Used as a key to determine which session the points belong to |
| SegmentId                 | In case there was a VRSegmentSequence that was prescribed |
| GameId                    | Game that prescribed this point. Lookup in VRGame table|

### VRMotionCaptureDemonstratedItem

| Field Name                     | Description         |
|:-------------------------------|:--------------------|
| id                        | Autogenerated. |
| InsertTime                | What time the point entered the database |
| AbsolutePositionHeadX          | X coordinate of the head |
| AbsolutePositionHeadY          | Y coordinate of the head |
| AbsolutePositionHeadZ          | Z coordinate of the head |
| AbsolutePositionRightHandX          | X coordinate of the right hand |
| AbsolutePositionRightHandY          | Y coordinate of the right hand |
| AbsolutePositionRightHandZ          | Z coordinate of the right hand |
| AbsolutePositionLeftHandX          | X coordinate of the left hand |
| AbsolutePositionLeftHandY          | Y coordinate of the left hand |
| AbsolutePositionLeftHandZ          | Z coordinate of the left hand |
| RelativePositionHeadX          | X coordinate of the head  |
| RelativePositionHeadY          | Y coordinate of the head |
| RelativePositionHeadZ          | Z coordinate of the head |
| RelativePositionRightHandX          | X coordinate of the right hand (subtracted from the head position) |
| RelativePositionRightHandY          | Y coordinate of the right hand (subtracted from the head position) |
| RelativePositionRightHandZ          | Z coordinate of the right hand (subtracted from the head position) |
| RelativePositionLeftHandX          | X coordinate of the left hand (subtracted from the head position) |
| RelativePositionLeftHandY          | Y coordinate of the left hand (subtracted from the head position) |
| RelativePositionLeftHandZ          | Z coordinate of the left hand (subtracted from the head position) |
| AbsoluteRotationHeadX          | X coordinate of rotation |
| AbsoluteRotationHeadY          | Y coordinate of rotation |
| AbsoluteRotationHeadZ          | Z coordinate of rotation |
| AbsoluteRotationHeadW          | W coordinate of rotation |
| AbsoluteRotationRightHandX          | X coordinate of rotation |
| AbsoluteRotationRightHandY          | Y coordinate of rotation |
| AbsoluteRotationRightHandZ          | Z coordinate of rotation |
| AbsoluteRotationRightHandW          | W coordinate of rotation |
| AbsoluteRotationLeftHandX          | X coordinate of rotation |
| AbsoluteRotationLeftHandY          | Y coordinate of rotation |
| AbsoluteRotationLeftHandZ          | Z coordinate of rotation |
| AbsoluteRotationLeftHandW          | W coordinate of rotation (quaternion value) |
| VRMotionCaptureSessionId  | Used as a key to determine which session the points belong to |
| SegmentId                 | In case there was a VRSegmentSequence that was prescribed |
| GameId                    | Game that prescribed this point. Lookup in VRGame table|
| VelocityLeftHand          | Velocity at point of recording |
| VelocityRightHand         | Velocity at point of recording |

### VRMotionCapturePrescribedItem

| Field Name                     | Description         |
|:-------------------------------|:--------------------|
| id                        | Autogenerated. |
| InsertTime                | What time the point entered the database |
| Hand                      | Which hand the point belonged to |
| CoordinateX               | X coordinate of the point. |
| CoordinateY               | Y coordinate of the point |
| CoordinateZ               | Z coordinate of the point |
| VRMotionCaptureSessionId  | Used as a key to determine which session the points belong to |
| SegmentId                 | In case there was a VRSegmentSequence that was prescribed |
| GameId                    | Game that prescribed this point. Lookup in VRGame table|
| SegmentEndTime            | In case the point was part of a VRSegmentSequence, when did the segment prescription end |
| PointDuration             | Length of time the point was active for the user  |
| CoordinateTimePrescribed  | Number of times this point was prescribed to the user |
| PointCollisionRadius      | Radius of what counts as a collision for this prescribed point. Lower numbers indicate greaater accuracy is required to hit the point |

### VRMotionCaptureSession

| Field Name                     | Description         |
|:-------------------------------|:--------------------|
| id                        | Autogenerated. |
| InsertTime                | Time that the record was inserted into the database (in UTC). |
| Density                   | Density value for the session. May be deprecated in the future |
| ArmLengthInInches         | Armlength of the user. |
| CollectionRate            | Seconds between data capture snapshots. |
| DemonstratedMotionVolume  | Total volume of demonstrated points reached. |
| PrescribedMotionVolume    | Total number of prescribed points in the session. |
| OculusUser                | Oculus Gamertag of the user. |
| VRDevice                  | Which VR device recorded the motion. (Unused) |
| SampleRate                | Seconds between data capture snapshots. (Unused) |

